Petascale direct numerical simulation of blood flow on 200k cores and heterogeneous architectures
We present a fast, petaflop-scalable algorithm for Stokesian particulate flows. Our goal is the direct simulation of blood, which we model as a mixture of a Stokesian fluid (plasma) and red blood cells (RBCs). Directly simulating blood is a challenging multiscale, multiphysics problem. We report simulations with up to 200 million deformable RBCs. The largest simulation amounts to 90 billion unknowns in space. In terms of the number of cells, we improve the state-of-the art by several orders of magnitude: the previous largest simulation, at the same physical fidelity as ours, resolved the flow of O(1,000-10,000) RBCs. Our approach has three distinct characteristics: (1) we faithfully represent the physics of RBCs by using nonlinear solid mechanics to capture the deformations of each cell; (2) we accurately resolve the long-range, N-body, hydrodynamic interactions between RBCs (which are caused by the surrounding plasma); and (3) we allow for the highly non-uniform distribution of RBCs in space. The new method has been implemented in the software library MOBO (for “Moving Boundaries”). We designed MOBO to support parallelism at all levels, including inter-node distributed memory parallelism, intra-node shared memory parallelism, data parallelism (vectorization), and fine-grained multithreading for GPUs. We have implemented and optimized the majority of the computation kernels on both Intel/AMD x86 and NVidia's Tesla/Fermi platforms for single and double floating point precision. Overall, the code has scaled on 256 CPU-GPUs on the Teragrid's Lincoln cluster and on 200,000 AMD cores of the Oak Ridge national Laboratory's Jaguar PF system. In our largest simulation, we have achieved 0.7 Petaflops/s of sustained performance on Jaguar.

A fast algorithm for simulating vesicle flows in three dimensions
A fast platform for simulating semi-flexible fiber suspensions applied to cell mechanics
Dynamic simulation of locally inextensible vesicles suspended in an arbitrary two-dimensional domain, a boundary integral method
Cytoplasmic flows as signatures for the mechanics of mitotic positioning
Interactions of astral microtubules (MTs), the pronuclear complex, and the cell cortex with the cytoplasm during pronuclear migration in the first cell division of Caenorhabditis elegans have two key consequences: cytoplasm-filled astral MTs behave as a porous medium, and different mechanisms result in different cytoplasmic flows.

Worst-case stress relief for microstructures
Additive fabrication technologies are limited by the types of material they can print: while the technologies are continuously improving, still only a relatively small discrete set of materials can be used in each printed object. At the same time, the low cost of introducing geometric complexity suggests the alternative of controlling the elastic material properties by producing microstructures, which can achieve behaviors significantly differing from the solid printing material. While promising results have been obtained in this direction, fragility is a significant problem blocking practical applications, especially for achieving soft material properties: due to stress concentrations at thin joints, deformations and repeated loadings are likely to cause fracture. We present a set of methods to minimize stress concentrations in microstructures by evolving their shapes. First, we demonstrate that the worst-case stress analysis problem (maximizing a stress measure over all possible unit loads) has an exact solution for periodic microstructures. We develop a new, accurate discretization of the shape derivative for stress objectives and introduce a low-dimensional parametric shape model for microstructures. This model supports robust minimization of maximal stress (approximated by an Lp norm with high p) and an efficient implementation of printability constraints. In addition to significantly reducing stresses (by a typical factor of 5X), the new method substantially expands the range of effective material properties covered by the collection of structures.

Boundary integral method for the flow of vesicles with viscosity contrast in three dimensions
A tensor-train accelerated solver for integral equations in complex geometries
Vesicle migration and spatial organization driven by flow line curvature
Cross-streamline migration of deformable entities is essential in many problems such as industrial particulate flows, DNA sorting, and blood rheology. Using two-dimensional numerical experiments, we have discovered that vesicles suspended in a flow with curved flow lines migrate towards regions of high flowline curvature, which are regions of high shear rates. The migration velocity of a vesicle is found to be a universal function of the normal stress difference and the flow curvature. This finding quantitatively demonstrates a direct coupling between a microscopic quantity (migration) and a macroscopic one (normal stress difference). Furthermore, simulations with multiple vesicles revealed a self-organization, which corresponds to segregation, in a rim closer to the inner cylinder, resulting from a subtle interaction among vesicles. Such segregation effects could have a significant impact on the rheology of vesicle flows.

Scalable simulation of realistic volume fraction red blood cell flows through vascular networks
High-resolution blood flow simulations have potential for developing better understanding biophysical phenomena at the microscale, such as vasodilation, vasoconstriction and overall vascular resistance. To this end, we present a scalable platform for the simulation of red blood cell (RBC) flows through complex capillaries by modeling the physical system as a viscous fluid with immersed deformable particles. We describe a parallel boundary integral equation solver for general elliptic partial differential equations, which we apply to Stokes flow through blood vessels. We also detail a parallel collision avoiding algorithm to ensure RBCs and the blood vessel remain contact-free. We have scaled our code on Stampede2 at the Texas Advanced Computing Center up to 34,816 cores. Our largest simulation enforces a contact-free state between four billion surface elements and solves for three billion degrees of freedom on one million RBCs and a blood vessel composed from two million patches.

Ubiquitous evaluation of layer potentials using Quadrature by Kernel-Independent Expansion
Contact-aware simulations of particulate Stokesian suspensions
A robust solver for elliptic PDEs in 3D complex geometries
A parallel algorithm for long-timescale simulation of concentrated vesicle suspensions in three dimensions
We develop a parallel boundary integral method for simulating highly concentrated vesicle suspensions in a Stokesian fluid. This method is an extension of our previous work [1]. The simulation of high volume fraction vesicle suspensions, which are representative of real biological systems (such as blood with 35% ∼ 50% volume fraction for RBC) presents several challenges. It requires computing accurate vesicle-vesicle interactions at length scales where standard quadratures are too expensive. The inter-vesicle separation can become arbitrarily small leading to vesicle collisions. Numerical errors can accumulate over time, making long-timescale simulations inaccurate. We tackle these challenges by developing state-of-the-art parallel algorithms for efficient computation of boundary integrals and an adaptive time-stepping scheme. We have also developed algorithms for handling vesicle collisions, remeshing of vesicle surfaces and correcting drift in vesicle area and volume. We study the accuracy of our method when compared to a reference solution and show convergence with the spatial discretization order and the time step size. We visualize long-timescale simulations for periodic Taylor-Green vortex flow and sedimentation of polydisperse vesicle suspensions with thousands of vesicles. For these flows, we present strong and weak scaling results on thousands of CPU cores on the Stampede system at Texas Advanced Computing Center.

Parallel contact-aware simulations of deformable particles in 3D Stokes flow
We present a parallel-scalable method for simulating non-dilute suspensions of deformable particles immersed in Stokesian fluid in three dimensions. A critical component in these simulations is robust and accurate collision handling. This work complements our previous work [L. Lu, A. Rahimian, and D. Zorin. Contact-aware simulations of particulate Stokesian suspensions. Journal of Computational Physics 347C: 160-182] by extending it to 3D and by introducing new parallel algorithms for collision detection and handling. We use a well-established boundary integral formulation with spectral Galerkin method to solve the fluid flow. The key idea is to ensure an interference-free particle configuration by introducing explicit contact constraints into the system. While such constraints are typically unnecessary in the formulation they make it possible to eliminate catastrophic loss of accuracy in the discretized problem by preventing contact explicitly. The incorporation of contact constraints results in a significant increase in stable time-step size for locally-implicit time-stepping and a reduction in the necessary number of discretization points for stability. Our method maintains the accuracy of previous methods at a significantly lower cost for dense suspensions and the time step size is independent from the volume fraction. Our method permits simulations with high volume fractions; we report results with up to 60% volume fraction. We demonstrated the parallel scaling of the algorithms on up to 16K CPU cores.

Parallel algorithms for direct blood flow simulations
Dynamics Of Inextensible Vesicles Suspended In A Confined Two-Dimensional Stokes Flow
DONE